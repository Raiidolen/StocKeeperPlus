{"openapi":"3.0.0","info":{"title":"API","version":"1.0.0"},"paths":{"/food":{"post":{"security":[{"cookieAuth":[]}],"tags":["Food"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FoodToAddSchema"}}}},"responses":{"201":{"description":"food created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FoodIDSchema"}}}},"400":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object","properties":{"message":{"type":"string","example":"The barcode field must be defined"},"rule":{"type":"string","example":"required"},"field":{"type":"string","example":"barcode"}}}}}}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"403":{"$ref":"#/components/responses/ForbiddenError"},"500":{"description":"Error server","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object"}}}}}}}}},"patch":{"security":[{"cookieAuth":[]}],"tags":["Food"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FoodToUpdateSchema"}}}},"responses":{"204":{"description":"food updated"},"400":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object","properties":{"message":{"type":"string","example":"The id field must be defined"},"rule":{"type":"string","example":"required"},"field":{"type":"string","example":"id"}}}}}}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"403":{"$ref":"#/components/responses/ForbiddenError"},"404":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"L'élément demandé n'a pas été trouvé."},"details":{"type":"array","items":{"type":"object"}}}}}}},"500":{"description":"Error server","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object"}}}}}}}}},"delete":{"security":[{"cookieAuth":[]}],"tags":["Food"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FoodIDSchema"}}}},"responses":{"204":{"description":"food deleted"},"400":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object","properties":{"message":{"type":"string","example":"The id field must be defined"},"rule":{"type":"string","example":"required"},"field":{"type":"string","example":"id"}}}}}}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"403":{"$ref":"#/components/responses/ForbiddenError"},"404":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"L'élément demandé n'a pas été trouvé."},"details":{"type":"array","items":{"type":"object"}}}}}}},"500":{"description":"Error server","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object"}}}}}}}}}},"/food/get/{id}":{"get":{"security":[{"cookieAuth":[]}],"tags":["Food"],"parameters":[{"in":"path","name":"id","schema":{"type":"integer"},"required":true,"description":"Numeric ID of the food to get"}],"responses":{"200":{"description":"food found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Food"}}}},"400":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object","properties":{"message":{"type":"string","example":"The id field must be a number"},"rule":{"type":"string","example":"number"},"field":{"type":"string","example":"id"}}}}}}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"404":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"L'élément demandé n'a pas été trouvé."},"details":{"type":"array","items":{"type":"object"}}}}}}},"500":{"description":"Error server","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object"}}}}}}}}}},"/food/barcode/{barcode}":{"get":{"security":[{"cookieAuth":[]}],"tags":["Food"],"parameters":[{"in":"path","name":"barcode","schema":{"$ref":"#/components/schemas/FoodBarcodeSchema"},"required":true,"description":"Barcode of the food"}],"responses":{"200":{"description":"food found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Food"}}}},"400":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object","properties":{"message":{"type":"string","example":"The barcode field format is invalid"},"rule":{"type":"string","example":"regex"},"field":{"type":"string","example":"barcode"}}}}}}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"404":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"L'élément demandé n'a pas été trouvé."},"details":{"type":"array","items":{"type":"object"}}}}}}},"500":{"description":"Error server","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object"}}}}}}}}}},"/food/all":{"get":{"security":[{"cookieAuth":[]}],"tags":["Food"],"responses":{"200":{"description":"list of foods","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Food"}}}}},"400":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object","properties":{"message":{"type":"string"}}}}}}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"500":{"description":"Error server","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object"}}}}}}}}}},"/user/register":{"post":{"security":[{"cookieAuth":[]}],"tags":["User"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterSchema"}}}},"responses":{"201":{"description":"user created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserIDSchema"}}}},"400":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object","properties":{"message":{"type":"string","example":"The mail field must be defined"},"rule":{"type":"string","example":"required"},"field":{"type":"string","example":"mail"}}}}}}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"500":{"description":"Error server","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object"}}}}}}}}}},"/user/me":{"get":{"security":[{"cookieAuth":[]}],"tags":["User"],"responses":{"200":{"description":"user retrieved","content":{"application/json":{"schema":{"type":"object","properties":{"mail":{"type":"string","format":"email","example":"username@gmail.com"},"username":{"type":"string","example":"username"},"isadmin":{"type":"boolean","example":false}}}}}},"400":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object","properties":{"message":{"type":"string"}}}}}}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"404":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"L'élément demandé n'a pas été trouvé."},"details":{"type":"array","items":{"type":"object"}}}}}}},"500":{"description":"Error server","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object"}}}}}}}}},"patch":{"security":[{"cookieAuth":[]}],"tags":["User"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateMeSchema"}}}},"responses":{"204":{"description":"user updated"},"400":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object","properties":{"message":{"type":"string"}}}}}}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"404":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"L'élément demandé n'a pas été trouvé."},"details":{"type":"array","items":{"type":"object"}}}}}}},"500":{"description":"Error server","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object"}}}}}}}}},"delete":{"security":[{"cookieAuth":[]}],"tags":["User"],"responses":{"204":{"description":"user deleted"},"400":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object","properties":{"message":{"type":"string","example":"The mail field must be a valid email address"},"rule":{"type":"string","example":"required"},"field":{"type":"string","example":"mail"}}}}}}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"404":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"L'élément demandé n'a pas été trouvé."},"details":{"type":"array","items":{"type":"object"}}}}}}},"500":{"description":"Error server","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object"}}}}}}}}}},"/user":{"post":{"security":[{"cookieAuth":[]}],"tags":["User"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserToAddSchema"}}}},"responses":{"201":{"description":"user created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserIDSchema"}}}},"400":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object","properties":{"message":{"type":"string","example":"The mail field must be defined"},"rule":{"type":"string","example":"required"},"field":{"type":"string","example":"mail"}}}}}}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"403":{"$ref":"#/components/responses/ForbiddenError"},"500":{"description":"Error server","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object"}}}}}}}}},"patch":{"security":[{"cookieAuth":[]}],"tags":["User"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserToUpdateSchema"}}}},"responses":{"204":{"description":"user updated"},"400":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object","properties":{"message":{"type":"string","example":"The mail field must be defined"},"rule":{"type":"string","example":"required"},"field":{"type":"string","example":"mail"}}}}}}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"403":{"$ref":"#/components/responses/ForbiddenError"},"404":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"L'élément demandé n'a pas été trouvé."},"details":{"type":"array","items":{"type":"object"}}}}}}},"500":{"description":"Error server","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object"}}}}}}}}},"delete":{"security":[{"cookieAuth":[]}],"tags":["User"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserIDSchema"}}}},"responses":{"204":{"description":"user deleted"},"400":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object","properties":{"message":{"type":"string","example":"The mail field must be a valid email address"},"rule":{"type":"string","example":"required"},"field":{"type":"string","example":"mail"}}}}}}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"403":{"$ref":"#/components/responses/ForbiddenError"},"404":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"L'élément demandé n'a pas été trouvé."},"details":{"type":"array","items":{"type":"object"}}}}}}},"500":{"description":"Error server","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object"}}}}}}}}}},"/user/get/{mail}":{"get":{"security":[{"cookieAuth":[]}],"tags":["User"],"parameters":[{"in":"path","name":"mail","schema":{"type":"string"},"required":true,"description":"String ID of the user to get"}],"responses":{"200":{"description":"user found","content":{"application/json":{"schema":{"type":"object","properties":{"mail":{"type":"string","format":"email","example":"username@gmail.com"},"username":{"type":"string","example":"username"},"isadmin":{"type":"boolean","example":false}}}}}},"400":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object","properties":{"message":{"type":"string","example":"The mail field must be a valid email address"},"rule":{"type":"string","example":"email"},"field":{"type":"string","example":"mail"}}}}}}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"403":{"$ref":"#/components/responses/ForbiddenError"},"404":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"L'élément demandé n'a pas été trouvé."},"details":{"type":"array","items":{"type":"object"}}}}}}},"500":{"description":"Error server","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object"}}}}}}}}}},"/user/all":{"get":{"security":[{"cookieAuth":[]}],"tags":["User"],"responses":{"200":{"description":"list of users","content":{"application/json":{"schema":{"type":"array","items":{"type":"object","properties":{"mail":{"type":"string","format":"email","example":"username@gmail.com"},"username":{"type":"string","example":"username"},"isadmin":{"type":"boolean","example":false}}}}}}},"400":{"description":"validation errors","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object","properties":{"message":{"type":"string"}}}}}}}}},"401":{"$ref":"#/components/responses/UnauthorizedError"},"403":{"$ref":"#/components/responses/ForbiddenError"},"500":{"description":"Error server","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Une erreur est survenue"},"details":{"type":"array","items":{"type":"object"}}}}}}}}}}},"components":{"schemas":{"Food":{"type":"object","properties":{"id":{"type":"integer","example":1},"label":{"type":"string","example":"Pâtes complètes"},"diet":{"type":"string","nullable":true,"example":"vegetarien"},"nutriscore":{"type":"string","nullable":true,"maxLength":1,"example":"A"},"measuringunit":{"type":"string","example":"gram"},"barcode":{"type":"string","example":"1234567890123"},"imagepath":{"type":"string","nullable":true,"example":"/images/default.jpg"}}},"User":{"type":"object","properties":{"mail":{"type":"string","format":"email","example":"username@gmail.com"},"username":{"type":"string","example":"username"},"password":{"type":"string","minLength":5,"example":"password"},"isadmin":{"type":"boolean","example":false}}},"FoodIDSchema":{"type":"object","properties":{"id":{"type":"integer"}},"required":["id"]},"FoodToAddSchema":{"type":"object","properties":{"label":{"type":"string"},"diet":{"type":"string"},"nutriscore":{"type":"string","maxLength":1,"pattern":"^[A-E]$"},"measuringunit":{"type":"string"},"barcode":{"type":"string","pattern":"^(?:\\d{8}|\\d{13})$"}},"required":["label","measuringunit","barcode"]},"FoodToUpdateSchema":{"type":"object","properties":{"id":{"type":"integer"},"label":{"type":"string"},"diet":{"type":"string"},"nutriscore":{"type":"string","maxLength":1,"pattern":"^[A-Ea-e]$"},"measuringunit":{"type":"string"},"barcode":{"type":"string","pattern":"^(?:\\d{8}|\\d{13})$"},"imagepath":{"type":"string"}},"required":["id","barcode"]},"FoodBarcodeSchema":{"type":"object","properties":{"barcode":{"type":"string","pattern":"^(?:\\d{8}|\\d{13})$"}},"required":["barcode"]},"UserIDSchema":{"type":"object","properties":{"mail":{"type":"string"}},"required":["mail"]},"UserToAddSchema":{"type":"object","properties":{"mail":{"type":"string","format":"email"},"username":{"type":"string"},"password":{"type":"string","minLength":5},"isadmin":{"type":"boolean"}},"required":["mail","username","password","isadmin"]},"RegisterSchema":{"type":"object","properties":{"mail":{"type":"string","format":"email"},"username":{"type":"string"},"password":{"type":"string","minLength":5}},"required":["mail","username","password"]},"UserToUpdateSchema":{"type":"object","properties":{"mail":{"type":"string","format":"email"},"username":{"type":"string"},"password":{"type":"string","minLength":5},"isadmin":{"type":"boolean"}},"required":["mail"]},"UpdateMeSchema":{"type":"object","properties":{"username":{"type":"string"},"password":{"type":"string","minLength":5}}}},"responses":{"getFood":{"description":"the food","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Food"}}}},"getFoodByBarcode":{"description":"the food found by barcode","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Food"}}}},"getAllFood":{"description":"list of foods","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Food"}}}}},"addFood":{"description":"food created","content":{"application/json":{"schema":{"type":"object","properties":{"id":{"type":"integer"}}}}}},"updateFood":{"description":"food updated"},"deleteFood":{"description":"food deleted"},"getUser":{"description":"the user","content":{"application/json":{"schema":{"type":"object","properties":{"mail":{"type":"string","format":"email","example":"username@gmail.com"},"username":{"type":"string","example":"username"},"isadmin":{"type":"boolean","example":false}}}}}},"getMyUser":{"description":"the information of the user connected","content":{"application/json":{"schema":{"type":"object","properties":{"mail":{"type":"string","format":"email","example":"username@gmail.com"},"username":{"type":"string","example":"username"},"isadmin":{"type":"boolean","example":false}}}}}},"getAllUser":{"description":"list of users","content":{"application/json":{"schema":{"type":"array","items":{"type":"object","properties":{"mail":{"type":"string","format":"email","example":"username@gmail.com"},"username":{"type":"string","example":"username"},"isadmin":{"type":"boolean","example":false}}}}}}},"addUser":{"description":"user created","content":{"application/json":{"schema":{"type":"object","properties":{"idMail":{"type":"string"}}}}}},"addUserNoAdmin":{"description":"user created (not an admin)","content":{"application/json":{"schema":{"type":"object","properties":{"idMail":{"type":"string"}}}}}},"updateUser":{"description":"user updated"},"updateMyUser":{"description":"user connected updated"},"deleteUser":{"description":"user deleted"},"deleteMyUser":{"description":"user connected deleted"},"ForbiddenError":{"description":"Access forbidden – admin role required","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"Accès refusé"}}}}}},"UnauthorizedError":{"description":"Access token is missing or invalid","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"Non authentifié (cookie manquant)"}}}}}}},"securitySchemes":{"cookieAuth":{"type":"apiKey","in":"cookie","name":"jwt"}}},"tags":[]}